

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15. FUNCTION Namelist &mdash; Truchas Reference Manual 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=93b25530" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"chtml": {"displayAlign": "left", "displayIndent": "2em"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="16. INDUCTION_HEATING Namelist" href="../induction_heating_namelist.html" />
    <link rel="prev" title="14. FLOW_PRESSURE_SOLVER and FLOW_VISCOUS_SOLVER Namelist" href="../FLOW_PRESSURE_SOLVER_and_FLOW_VISCOUS_SOLVER_Namelists/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Truchas Reference Manual
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../BODY_Namelist/index.html">2. BODY Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complex_function_namelist.html">3. COMPLEX_FUNCTION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complex_vfunction_namelist.html">4. COMPLEX_VFUNCTION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DIFFUSION_Solver_Namelist/index.html">5. DIFFUSION Solver Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ELECTROMAGNETIC_BC_Namelist/index.html">6. ELECTROMAGNETIC_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EM_MESH_Namelist/index.html">7. EM_MESH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ENCLOSURE_RADIATION_Namelist/index.html">8. ENCLOSURE_RADIATION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ENCLOSURE_SURFACE_Namelist/index.html">9. ENCLOSURE_SURFACE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../EVAPORATION_Namelist/index.html">10. EVAPORATION Namelist (Experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fdme_solver_namelist.html">11. FDME_SOLVER Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_Namelist/index.html">12. FLOW Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_BC_Namelist/index.html">13. FLOW_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FLOW_PRESSURE_SOLVER_and_FLOW_VISCOUS_SOLVER_Namelists/index.html">14. FLOW_PRESSURE_SOLVER and FLOW_VISCOUS_SOLVER Namelist</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">15. FUNCTION Namelist</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">15.1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-namelist-features">15.2. FUNCTION Namelist Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#components">15.3. Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#name">Name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#type">Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#library-path">Library_Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#library-symbol">Library_Symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poly-coefficients">Poly_Coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poly-exponents">Poly_Exponents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#poly-refvars">Poly_Refvars</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tabular-data">Tabular_Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tabular-dim">Tabular_Dim</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tabular-extrap">Tabular_Extrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tabular-interp">Tabular_Interp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smooth-step-x0">Smooth_Step_X0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smooth-step-x1">Smooth_Step_X1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smooth-step-y0">Smooth_Step_Y0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#smooth-step-y1">Smooth_Step_Y1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../induction_heating_namelist.html">16. INDUCTION_HEATING Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../INDUCTION_SOURCE_FIELD_Namelist/index.html">17. INDUCTION_SOURCE_FIELD Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MATERIAL_and_PHASE_Namelists/index.html">18. MATERIAL and PHASE Namelists</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MESH_Namelist/index.html">19. MESH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MICROSTRUCTURE_Namelist/index.html">20. MICROSTRUCTURE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microwave_heating_namelist.html">21. MICROWAVE_HEATING Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NUMERICS_Namelist/index.html">22. NUMERICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OUTPUTS_Namelist/index.html">23. OUTPUTS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHASE_CHANGE_Namelist/index.html">24. PHASE_CHANGE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHYSICAL_CONSTANTS_Namelist/index.html">25. PHYSICAL_CONSTANTS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PHYSICS_Namelist/index.html">26. PHYSICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PROBE_Namelist/index.html">27. PROBE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RESTART_Namelist/index.html">28. RESTART Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SIMULATION_CONTROL_Namelist/index.html">29. SIMULATION_CONTROL Namelist (Experimental)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SOLID_MECHANICS_Namelist/index.html">30. SOLID_MECHANICS Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SOLID_MECHANICS_BC_Namelist/index.html">31. SOLID_MECHANICS_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPECIES_BC_Namelist/index.html">32. SPECIES_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SPECIES_SOURCE_Namelist/index.html">33. SPECIES_SOURCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tdme_joule_solver_namelist.html">34. TDME_JOULE_SOLVER Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../THERMAL_BC_Namelist/index.html">35. THERMAL_BC Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../THERMAL_SOURCE_Namelist/index.html">36. THERMAL_SOURCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TOOLHEAD_Namelist/index.html">37. TOOLHEAD Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TOOLPATH_Namelist/index.html">38. TOOLPATH Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TURBULENCE_Namelist/index.html">39. TURBULENCE Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VFUNCTION_Namelist/index.html">40. VFUNCTION Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VISCOPLASTIC_MODEL_Namelist/index.html">41. VISCOPLASTIC_MODEL Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../VISCOPLASTIC_SOLVER_Namelist/index.html">42. VISCOPLASTIC_SOLVER Namelist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rade/index.html">43. Radiation Enclosure Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/index.html">44. <code class="docutils literal notranslate"><span class="pre">truchas</span></code> Python Module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Truchas Reference Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">15. </span>FUNCTION Namelist</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/FUNCTION_Namelist/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound" id="function-namelist">
</div>
<section id="id1">
<h1><span class="section-number">15. </span>FUNCTION Namelist<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">15.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>There is often a need to specify phase properties, boundary condition data, source data, etc., as functions rather than constants. The <a class="reference internal" href="#function-namelist"><span class="std std-ref">FUNCTION</span></a> namelist provides a means for defining functions that can be used in many situations.</p>
<p>The namelist can define several types of functions: a multi-variable polynomial, a continuous piecewise linear function defined by a table of values, a smooth step function, and with certain Truchas build configurations, a general user-provided function from a shared object library that is dynamically loaded at runtime. The functions are functions of <span class="math notranslate nohighlight">\(m\)</span> variables. The expected number of variables and what unknowns they represent (i.e., temperature, time, x-coordinate, etc.) depends on the context in which the function is used, and this will be detailed by the documentation of those namelists where these functions can be used.</p>
<p><strong>Polynomial Function</strong> This function is a polynomial in the variables <span class="math notranslate nohighlight">\(v = (v_1,.....,v_m)\)</span> of the form</p>
<div class="math notranslate nohighlight" id="equation-poly-func">
<span class="eqno">(15.1.1)<a class="headerlink" href="#equation-poly-func" title="Link to this equation"></a></span>\[f(v) = \sum_{j=1}^{n} c_j \prod_{i=1}^{m}(v_i - a_i)^{(e_{ij})}\]</div>
<p>with coefficients <span class="math notranslate nohighlight">\(c_j\)</span>, integer-valued exponents <span class="math notranslate nohighlight">\(e^{ij}\)</span>, and arbitrary reference point <span class="math notranslate nohighlight">\(a= (a_1,...,a_m)\)</span>. The coefficients are specified by <a class="reference internal" href="#func-pc"><span class="std std-ref">Poly_Coefficients</span></a>, the exponents by <a class="reference internal" href="#func-pe"><span class="std std-ref">Poly_Exponents</span></a>, and the reference point by <a class="reference internal" href="#func-pr"><span class="std std-ref">Poly_Refvars</span></a>.</p>
<p><strong>Tabular Function</strong> This is a continuous, single-variable function <span class="math notranslate nohighlight">\(y = f(x)\)</span> interpolated from a sequence of data points <span class="math notranslate nohighlight">\((x_i,y_i), i= 1,...,n,\)</span> with <span class="math notranslate nohighlight">\(x_i &lt; x_i+1\)</span>. A smooth interpolation method is available in addition to the standard linear interpolation; see <a class="reference internal" href="#func-ti"><span class="std std-ref">Tabular_Interp</span></a>. There are also two different methods for extrapolating on <span class="math notranslate nohighlight">\(x &lt; x_1\)</span> and <span class="math notranslate nohighlight">\(x &gt; x_n\)</span>; see <a class="reference internal" href="#func-te"><span class="std std-ref">Tabular_Extrap</span></a>.</p>
<p><strong>Smooth Step Function</strong> This function is a smoothed <span class="math notranslate nohighlight">\((C_1)\)</span> step function in a single variable <span class="math notranslate nohighlight">\(v= (x)\)</span> of the form</p>
<div class="math notranslate nohighlight" id="equation-poly-multi">
\[
f(x) =
\left\{
\begin{array}{
  &#64;{}% no padding
  l&#64;{\quad}% some padding
  r&#64;{}% no padding
  &gt;{{}}r&#64;{}% no padding
  &gt;{{}}l&#64;{}% no padding
}
  y_0,&amp; if &amp;x \leq x_0 \\
  y_0 + (y_1 - y_0) s^2 (3-2s), s \equiv (x - x_0)/(x_1 - x_0), &amp; when  &amp;x \in (x_0, x_1) \\
  y_1,&amp; if &amp;x \geq x_1,
\end{array}
\right.
\]</div><p>with parameters <span class="math notranslate nohighlight">\(x_0\)</span>, <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(y_0\)</span>, and <span class="math notranslate nohighlight">\(y_1\)</span></p>
<p><strong>Shared Library Function</strong> This is a function from a shared object library having a simple Fortran 77 or C compatible interface. Written in Fortran 77 the function interface must look like</p>
<p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">precision</span> <span class="pre">function</span> <span class="pre">myfun</span> <span class="pre">(v,</span> <span class="pre">p)</span> <span class="pre">bind(c)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">precision</span> <span class="pre">v(*),</span> <span class="pre">p(*)</span></code></p>
<p>where <strong>myfunc</strong> can, of course, be any name. The equivalent C interface is</p>
<p><code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">myfun</span> <span class="pre">(double</span> <span class="pre">v[],</span> <span class="pre">double</span> <span class="pre">p[]);</span></code></p>
<p>The vector of variables <span class="math notranslate nohighlight">\(v= (v_1,...,v_m)\)</span> is passed in the argument <span class="math notranslate nohighlight">\(v\)</span> and a vector of parameter values specified by <a class="reference internal" href="#func-param"><span class="std std-ref">Parameters</span></a> is passed in the argument <span class="math notranslate nohighlight">\(p\)</span>. Instructions for compiling the code and creating a shared object library can be found in the Truchas Installation Guide. The path to the library is given by <a class="reference internal" href="#func-lp"><span class="std std-ref">Library_Path</span></a> and the name of the function (myfun, e.g.) is given by <a class="reference internal" href="#func-ls"><span class="std std-ref">Library_Symbol</span></a>. Note that the bind(c) attribute on the function declaration inhibits the Fortran compiler from mangling the function name (by appending an underscore, for example) as it normally would.</p>
</section>
<section id="function-namelist-features">
<h2><span class="section-number">15.2. </span>FUNCTION Namelist Features<a class="headerlink" href="#function-namelist-features" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line"><strong>Required/Optional        :</strong> Optional</div>
<div class="line"><strong>Single/Multiple Instances:</strong> Multiple</div>
</div>
</section>
<section id="components">
<h2><span class="section-number">15.3. </span>Components<a class="headerlink" href="#components" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#func-name"><span class="std std-ref">Name</span></a></p></li>
<li><p><a class="reference internal" href="#func-type"><span class="std std-ref">Type</span></a></p></li>
<li><p><a class="reference internal" href="#func-lp"><span class="std std-ref">Library_Path</span></a></p></li>
<li><p><a class="reference internal" href="#func-ls"><span class="std std-ref">Library_Symbol</span></a></p></li>
<li><p><a class="reference internal" href="#func-param"><span class="std std-ref">Parameters</span></a></p></li>
<li><p><a class="reference internal" href="#func-pc"><span class="std std-ref">Poly_Coefficients</span></a></p></li>
<li><p><a class="reference internal" href="#func-pe"><span class="std std-ref">Poly_Exponents</span></a></p></li>
<li><p><a class="reference internal" href="#func-pr"><span class="std std-ref">Poly_Refvars</span></a></p></li>
<li><p><a class="reference internal" href="#func-ssx0"><span class="std std-ref">Smooth_Step_X0</span></a></p></li>
<li><p><a class="reference internal" href="#func-ssx1"><span class="std std-ref">Smooth_Step_X1</span></a></p></li>
<li><p><a class="reference internal" href="#func-ssy0"><span class="std std-ref">Smooth_Step_Y0</span></a></p></li>
<li><p><a class="reference internal" href="#func-ssy1"><span class="std std-ref">Smooth_Step_Y1</span></a></p></li>
<li><p><a class="reference internal" href="#func-td"><span class="std std-ref">Tabular_Data</span></a></p></li>
<li><p><a class="reference internal" href="#func-tdim"><span class="std std-ref">Tabular_Dim</span></a></p></li>
<li><p><a class="reference internal" href="#func-te"><span class="std std-ref">Tabular_Extrap</span></a></p></li>
<li><p><a class="reference internal" href="#func-ti"><span class="std std-ref">Tabular_Interp</span></a></p></li>
</ul>
<section id="name">
<span id="func-name"></span><h3>Name<a class="headerlink" href="#name" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : A unique name by which this function can be referenced by other namelists.</div>
<div class="line"><strong>Type</strong>        : A case-sensitive string of up to 31 characters.</div>
<div class="line"><strong>Default</strong>     : None</div>
</div>
</section>
<section id="type">
<span id="func-type"></span><h3>Type<a class="headerlink" href="#type" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The type of function defined by the namelist.</div>
<div class="line"><strong>Type</strong>        : A case-sensitive string</div>
<div class="line"><strong>Default</strong>     : None</div>
<div class="line"><strong>Valid Values</strong>: “polynomial” for a polynomial function,”tabular” for a tabular function,”smooth step” for a smooth step function, or “library” for a function from a shared object library. The “library” value is not available with a Truchas executable built with the “dynamic loading” option disabled.</div>
</div>
</section>
<section id="library-path">
<span id="func-lp"></span><h3>Library_Path<a class="headerlink" href="#library-path" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The path to the shared object library that contains the function.</div>
<div class="line"><strong>Type</strong>        : A string of up to 128 characters.</div>
<div class="line"><strong>Default</strong>     : None</div>
</div>
</section>
<section id="library-symbol">
<span id="func-ls"></span><h3>Library_Symbol<a class="headerlink" href="#library-symbol" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The symbol name of the function within the shared object file.</div>
<div class="line"><strong>Type</strong>        : A string of up to 128 characters.</div>
<div class="line"><strong>Default</strong>     : None</div>
<div class="line"><strong>Notes</strong>       : Unless the Fortran function is declared with the BIND(C) attribute, which is the recommended practice, a Fortran compiler will almost always mangle the name of the function so that the symbol name is not quite the same as the name in the source code. Use the UNIX/Linux command-line utility <strong>nm</strong> to list the symbol names in the library file to determine the correct name to use here.</div>
</div>
</section>
<section id="parameters">
<span id="func-param"></span><h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : Optional parameter values to pass to the shared library function.</div>
<div class="line"><strong>Type</strong>        : real vector of up to 16 values</div>
<div class="line"><strong>Default</strong>     : None</div>
</div>
</section>
<section id="poly-coefficients">
<span id="func-pc"></span><h3>Poly_Coefficients<a class="headerlink" href="#poly-coefficients" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The coefficients <span class="math notranslate nohighlight">\(c_j\)</span> of the polynomial <a class="reference internal" href="#equation-poly-func">Eq.15.1.1</a></div>
<div class="line"><strong>Type</strong>        : real vector of up to 64 values</div>
<div class="line"><strong>Default</strong>     : None</div>
</div>
</section>
<section id="poly-exponents">
<span id="func-pe"></span><h3>Poly_Exponents<a class="headerlink" href="#poly-exponents" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The exponents <span class="math notranslate nohighlight">\(e_{ij}\)</span> of the polynomial <a class="reference internal" href="#equation-poly-func">Eq.15.1.1</a></div>
<div class="line"><strong>Type</strong>        : integer array</div>
<div class="line"><strong>Default</strong>     : None</div>
<div class="line"><strong>Notes</strong>       : Namelist array input is very flexible. The syntax</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Poly_Exponents(i,j)</span> <span class="pre">=</span> <span class="pre">.....</span></code></p>
<p>defines the value for exponent <span class="math notranslate nohighlight">\(e_{ij}\)</span>. All the variable exponents for coefficient <span class="math notranslate nohighlight">\(j\)</span> can be defined at once by listing their values with the syntax</p>
<p><code class="docutils literal notranslate"><span class="pre">Poly_Exponents(:,j)</span> <span class="pre">=</span> <span class="pre">.....</span></code></p>
<p>In some circumstances it is possible to omit providing 0-exponents for variables that are unused. For example, if the function is expected to be a function of (t,x,y,z), but a polynomial in only t is desired, one can just define a 1-variable polynomial and entirely ignore the remaining variables. On the other hand, if a polynomial in z is desired, one must specify 0-valued exponents for all the preceding variables.</p>
</section>
<section id="poly-refvars">
<span id="func-pr"></span><h3>Poly_Refvars<a class="headerlink" href="#poly-refvars" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The optional reference point a of the polynomial <a class="reference internal" href="#equation-poly-func">Eq.15.1.1</a></div>
<div class="line"><strong>Type</strong>        : real vector</div>
<div class="line"><strong>Default</strong>     : 0.0</div>
</div>
</section>
<section id="tabular-data">
<span id="func-td"></span><h3>Tabular_Data<a class="headerlink" href="#tabular-data" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The table of values <span class="math notranslate nohighlight">\((x_i,y_i)\)</span> defining a tabular function <span class="math notranslate nohighlight">\(y=f(x)\)</span>. See also <a class="reference internal" href="#func-tdim"><span class="std std-ref">Tabular_Dim</span></a>, <a class="reference internal" href="#func-ti"><span class="std std-ref">Tabular_Interp</span></a>, and <a class="reference internal" href="#func-te"><span class="std std-ref">Tabular_Extrap</span></a> for additional variables that define the function.</div>
<div class="line"><strong>Type</strong>        : real array</div>
<div class="line"><strong>Default</strong>     : None</div>
<div class="line"><strong>Notes</strong>       : This is a <span class="math notranslate nohighlight">\(2 × n\)</span> array with <span class="math notranslate nohighlight">\(n \leq 100\)</span>. Namelist array input is very flexible and the values can be specified in several ways. For example, the syntax</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tabular_Data</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="o">.......</span><span class="p">,</span> <span class="n">x_n</span>
<span class="n">Tabular_Data</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">y_1</span><span class="p">,</span> <span class="n">y_2</span><span class="p">,</span> <span class="o">.......</span><span class="p">,</span> <span class="n">y_n</span>
</pre></div>
</div>
<p>specifies the <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> values as separate lists. Or the values can be input naturally as a table</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tabular_Data</span> <span class="o">=</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">y_1</span>
               <span class="n">x_2</span><span class="p">,</span> <span class="n">y_2</span>
               <span class="o">...</span>
               <span class="n">x_n</span><span class="p">,</span> <span class="n">y_n</span>
</pre></div>
</div>
<p>The line breaks are unnecessary, of course, and are there only for readability as a table.</p>
</section>
<section id="tabular-dim">
<span id="func-tdim"></span><h3>Tabular_Dim<a class="headerlink" href="#tabular-dim" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The dimension in the m-vector of independent variables that serves as the independent variable for the single-variable tabular function.</div>
<div class="line"><strong>Type</strong>        : integer</div>
<div class="line"><strong>Default</strong>     : 1</div>
<div class="line"><strong>Notes</strong>       : Functions defined by this namelist are generally functions of m variables <span class="math notranslate nohighlight">\((v_1,v_2,...,v_m)\)</span>. The number of variables and the unknowns to which they correspond depend on the context where the function is used. One of these variables needs to be selected to be the independent variable used for the tabular function. In typical use cases the desired tabular function will depend on time or temperature. Those unknowns are often the first variable, and the default value of <a class="reference internal" href="#func-tdim"><span class="std std-ref">Tabular_Dim</span></a> is appropriate.</div>
</div>
</section>
<section id="tabular-extrap">
<span id="func-te"></span><h3>Tabular_Extrap<a class="headerlink" href="#tabular-extrap" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : Specifies the method used for extrapolating outside the range of tabular function data points.</div>
<div class="line"><strong>Type</strong>        : case-insensitive string</div>
<div class="line"><strong>Default</strong>     : “nearest”</div>
<div class="line"><strong>Valid values</strong>: “nearest”, “linear”</div>
<div class="line"><strong>Notes</strong>       : Nearest extrapolation continues the <span class="math notranslate nohighlight">\(y\)</span> value at the first or last data point. Linear extrapolation uses the slope of the first or last data interval, or if Akima smoothing is used (see <a class="reference internal" href="#func-ti"><span class="std std-ref">Tabular_Interp</span></a>) the computed slope at the first or last data point.</div>
</div>
</section>
<section id="tabular-interp">
<span id="func-ti"></span><h3>Tabular_Interp<a class="headerlink" href="#tabular-interp" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : Specifies the method used for interpolating between tabular function data points.</div>
<div class="line"><strong>Type</strong>        : case-insensitive string</div>
<div class="line"><strong>Default</strong>     : “linear”</div>
<div class="line"><strong>Valid values</strong>: “linear”, “akima”</div>
<div class="line"><strong>Notes</strong>       : Akima interpolation <a class="footnote-reference brackets" href="#footcite-akima1970new" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> uses Hermit cubic interpolation on each data interval, with the slope at each data point computed from the linear slopes on the neighboring four intervals. The resulting function is <span class="math notranslate nohighlight">\(C^1\)</span> smooth. To determine the slope at the first two and last two data points, two virtual data intervals are generated at the beginning and at the end using quadratic extrapolation. The algorithm seeks to avoid undulations in the interpolated function where the data suggests a flat region though its choice of slopes at data points. <a class="reference internal" href="#fig-akima"><span class="std std-numref">Figure 15.3.1 A</span></a> shows the typical smooth Akima interpolation. If the first interval was expected to be flat, the exhibited undulation would likely be unacceptable. By inserting an additional data point to create successive intervals with the same slope, as in <a class="reference internal" href="#fig-akima"><span class="std std-numref">Figure 15.3.1 BC</span></a>, the algorithm identifies it as a flat region and preserves it in the interpolation. Where two flat regions with differing slopes meet, it is impossible to simultaneously retain smoothness and preserve flatness. In this case a modification to the Akima algorithm used by Matlab’s tablelookup function is adopted, which gives preference to the region with smaller slope as shown in <a class="reference internal" href="#fig-akima"><span class="std std-numref">Figure 15.3.1 D</span></a></div>
</div>
<figure class="align-center" id="id4">
<span id="fig-akima"></span><a class="reference internal image-reference" href="../_images/akima.png"><img alt="../_images/akima.png" src="../_images/akima.png" style="width: 550px;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 15.3.1 </span><span class="caption-text">Examples of smooth Akima interpolation.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="smooth-step-x0">
<span id="func-ssx0"></span><h3>Smooth_Step_X0<a class="headerlink" href="#smooth-step-x0" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The parameter <span class="math notranslate nohighlight">\(x_0\)</span> of the function <a class="reference internal" href="#equation-poly-multi">Eq.15.1.2</a></div>
<div class="line"><strong>Type</strong>        : real</div>
<div class="line"><strong>Default</strong>     : none</div>
<div class="line"><strong>Valid values</strong>: Require only <span class="math notranslate nohighlight">\(x_0 \leq x_1\)</span>.</div>
</div>
</section>
<section id="smooth-step-x1">
<span id="func-ssx1"></span><h3>Smooth_Step_X1<a class="headerlink" href="#smooth-step-x1" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The parameter <span class="math notranslate nohighlight">\(x_1\)</span> of the function <a class="reference internal" href="#equation-poly-multi">Eq.15.1.2</a></div>
<div class="line"><strong>Type</strong>        : real</div>
<div class="line"><strong>Default</strong>     : none</div>
<div class="line"><strong>Valid values</strong>: Require only <span class="math notranslate nohighlight">\(x_0 \leq x_1\)</span>.</div>
</div>
</section>
<section id="smooth-step-y0">
<span id="func-ssy0"></span><h3>Smooth_Step_Y0<a class="headerlink" href="#smooth-step-y0" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The parameter <span class="math notranslate nohighlight">\(y_0\)</span> of the function <a class="reference internal" href="#equation-poly-multi">Eq.15.1.2</a></div>
<div class="line"><strong>Type</strong>        : real</div>
<div class="line"><strong>Default</strong>     : none</div>
</div>
</section>
<section id="smooth-step-y1">
<span id="func-ssy1"></span><h3>Smooth_Step_Y1<a class="headerlink" href="#smooth-step-y1" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line"><strong>Description</strong> : The parameter <span class="math notranslate nohighlight">\(y_1\)</span> of the function <a class="reference internal" href="#equation-poly-multi">Eq.15.1.2</a></div>
<div class="line"><strong>Type</strong>        : real</div>
<div class="line"><strong>Default</strong>     : none</div>
</div>
<div class="docutils container" id="id3">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-akima1970new" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>Hiroshi Akima. A new method of interpolation and smooth curve fitting based on local procedures. <em>Journal of the ACM (JACM)</em>, 17(4):589–602, 1970.</p>
</aside>
</aside>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../FLOW_PRESSURE_SOLVER_and_FLOW_VISCOUS_SOLVER_Namelists/index.html" class="btn btn-neutral float-left" title="14. FLOW_PRESSURE_SOLVER and FLOW_VISCOUS_SOLVER Namelist" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../induction_heating_namelist.html" class="btn btn-neutral float-right" title="16. INDUCTION_HEATING Namelist" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, The Truchas Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>