

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>METIS patching (METIS) &mdash; Truchas 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/sphinxdoc.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=453172ad" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Vertex Anchor Cluster (VAC)" href="vac.html" />
    <link rel="prev" title="Variational Shape Approximation (VSA)" href="vsa.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Truchas
              <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Radiation Enclosure Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#contents">Contents</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Enclosure Patches</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html#patch-algorithms">Patch Algorithms</a><ul class="current">
<li class="toctree-l5"><a class="reference internal" href="pave.html">Vertex Anchor Cluster Paving (PAVE)</a></li>
<li class="toctree-l5"><a class="reference internal" href="vsa.html">Variational Shape Approximation (VSA)</a></li>
<li class="toctree-l5 current"><a class="current reference internal" href="#">METIS patching (METIS)</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#algorithm">Algorithm</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#outline">Outline</a></li>
<li class="toctree-l7"><a class="reference internal" href="#dual-graph">Dual Graph</a></li>
<li class="toctree-l7"><a class="reference internal" href="#partitioning-objective">Partitioning objective</a><ul>
<li class="toctree-l8"><a class="reference internal" href="#edge-weight">Edge Weight</a></li>
<li class="toctree-l8"><a class="reference internal" href="#face-weight">Face Weight</a><ul>
<li class="toctree-l9"><a class="reference internal" href="#load-imbalance">Load Imbalance</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#namelist-parameters">Namelist Parameters</a><ul>
<li class="toctree-l7"><a class="reference internal" href="#initialization-parameters">Initialization Parameters</a><ul>
<li class="toctree-l8"><a class="reference internal" href="#metis-face-patch-ratio">METIS_FACE_PATCH_RATIO</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-edge-weight">METIS_EDGE_WEIGHT</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-face-weight">METIS_FACE_WEIGHT</a></li>
</ul>
</li>
<li class="toctree-l7"><a class="reference internal" href="#metis-library-parameters">METIS library parameters</a><ul>
<li class="toctree-l8"><a class="reference internal" href="#metis-ptype">METIS_PTYPE</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-objtype">METIS_OBJTYPE</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-ctype">METIS_CTYPE</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-iptype">METIS_IPTYPE</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-ncuts">METIS_NCUTS</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-niter">METIS_NITER</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-seed">METIS_SEED</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-minconn">METIS_MINCONN</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-no2hop">METIS_NO2HOP</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-contig">METIS_CONTIG</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-ufactor">METIS_UFACTOR</a></li>
<li class="toctree-l8"><a class="reference internal" href="#metis-dbglvl">METIS_DBGLVL</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="vac.html">Vertex Anchor Cluster (VAC)</a></li>
<li class="toctree-l5"><a class="reference internal" href="index.html#general-guidance">General guidance</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="index.html#patches-namelist">PATCHES Namelist</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Truchas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Radiation Enclosure Tools</a></li>
          <li class="breadcrumb-item"><a href="index.html">Enclosure Patches</a></li>
      <li class="breadcrumb-item active">METIS patching (METIS)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tools/RadE/patches/metis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="metis-patching-metis">
<h1>METIS patching (METIS)<a class="headerlink" href="#metis-patching-metis" title="Link to this heading"></a></h1>
<figure class="align-center" id="id9" style="width: 50%">
<img alt="../../../_images/basic_hemi_metis_2.png" src="../../../_images/basic_hemi_metis_2.png" />
<figcaption>
<p><span class="caption-text">Result of METIS on a quarter cyclinder.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The METIS patching algorithm is based on the observation that clustering the enclosure faces is
equivalent to partitioning the enclosure’s dual graph. This is the graph whose nodes are the
enclosure faces and edges are the enclosure edges shared by faces. The METIS patching algorithm
leverages the well-known METIS library <span id="id1">[<a class="reference internal" href="#id8" title="George Karypis and Vipin Kumar. A fast and high quality multilevel scheme for partitioning irregular graphs. SIAM J. Sci. Comput., 20(1):359–392, December 1998.">1</a>]</span> to partition the dual graph.</p>
<p>Since the METIS graph partitioner minimizes the number of edges between partitions, the resulting
partitions naturally correspond to connected patches with roughly circular shapes. Moreover, by
appropriately weighting the vertices and edges of the dual graph, the generated patches can have
desirable properties, such as roughly constant areas or number of faces.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Throughout this document the terms ‘METIS library’ or ‘METIS graph partitioner’ refer to the
external library and its routines. The terms ‘METIS patching algorithm’ or ‘METIS algorithm’ refer
to the patching algorithm described in this document.</p>
</div>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#algorithm" id="id10">Algorithm</a></p>
<ul>
<li><p><a class="reference internal" href="#outline" id="id11">Outline</a></p></li>
<li><p><a class="reference internal" href="#dual-graph" id="id12">Dual Graph</a></p></li>
<li><p><a class="reference internal" href="#partitioning-objective" id="id13">Partitioning objective</a></p>
<ul>
<li><p><a class="reference internal" href="#edge-weight" id="id14">Edge Weight</a></p></li>
<li><p><a class="reference internal" href="#face-weight" id="id15">Face Weight</a></p>
<ul>
<li><p><a class="reference internal" href="#load-imbalance" id="id16">Load Imbalance</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#namelist-parameters" id="id17">Namelist Parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#initialization-parameters" id="id18">Initialization Parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#metis-face-patch-ratio" id="id19">METIS_FACE_PATCH_RATIO</a></p></li>
<li><p><a class="reference internal" href="#metis-edge-weight" id="id20">METIS_EDGE_WEIGHT</a></p></li>
<li><p><a class="reference internal" href="#metis-face-weight" id="id21">METIS_FACE_WEIGHT</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#metis-library-parameters" id="id22">METIS library parameters</a></p>
<ul>
<li><p><a class="reference internal" href="#metis-ptype" id="id23">METIS_PTYPE</a></p></li>
<li><p><a class="reference internal" href="#metis-objtype" id="id24">METIS_OBJTYPE</a></p></li>
<li><p><a class="reference internal" href="#metis-ctype" id="id25">METIS_CTYPE</a></p></li>
<li><p><a class="reference internal" href="#metis-iptype" id="id26">METIS_IPTYPE</a></p></li>
<li><p><a class="reference internal" href="#metis-ncuts" id="id27">METIS_NCUTS</a></p></li>
<li><p><a class="reference internal" href="#metis-niter" id="id28">METIS_NITER</a></p></li>
<li><p><a class="reference internal" href="#metis-seed" id="id29">METIS_SEED</a></p></li>
<li><p><a class="reference internal" href="#metis-minconn" id="id30">METIS_MINCONN</a></p></li>
<li><p><a class="reference internal" href="#metis-no2hop" id="id31">METIS_NO2HOP</a></p></li>
<li><p><a class="reference internal" href="#metis-contig" id="id32">METIS_CONTIG</a></p></li>
<li><p><a class="reference internal" href="#metis-ufactor" id="id33">METIS_UFACTOR</a></p></li>
<li><p><a class="reference internal" href="#metis-dbglvl" id="id34">METIS_DBGLVL</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#references" id="id35">References</a></p></li>
</ul>
</nav>
<section id="algorithm">
<h2>Algorithm<a class="headerlink" href="#algorithm" title="Link to this heading"></a></h2>
<p>The METIS algorithm begins by constructing the dual graph of the enclosure. By default, the face
areas and edge lengths of the enclosure are computed and assigned as weights to the corresponding
elements of the dual graph, respectively the vertices and edges. This weighted graph is passed to
the METIS library, which partitions the dual graph vertices and hence produces a patching of the
enclosure. Finally, a fix-up routine breaks up disconnected patches, ensuring that the final output
consists only of connected patches.</p>
<section id="outline">
<h3>Outline<a class="headerlink" href="#outline" title="Link to this heading"></a></h3>
<p>The following is a high-level outline of the METIS algorithm.</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong></p>
<ol class="arabic simple">
<li><p>Compute the area and normal of each face.</p></li>
<li><p>Generate the dual graph of the mesh (i.e. face adjacency graph). Faces at angles greater than
<a class="reference internal" href="patches_namelist.html#max-angle"><span class="std std-ref">MAX_ANGLE</span></a> are not adjacent.</p></li>
<li><p>Let NPART = NFACE / METIS_FACE_PATCH_RATIO, where NFACE is the total number of faces
in the enclosure.</p></li>
<li><p>If <a class="reference internal" href="#metis-face-weight"><span class="std std-ref">METIS_FACE_WEIGHT</span></a> is true, generate the vertex weights of
the dual graph. The vertex weights are the areas of the corresponding faces divided by the
minimum face area.</p></li>
<li><p>If <a class="reference internal" href="#metis-edge-weight"><span class="std std-ref">METIS_EDGE_WEIGHT</span></a> is true, generate the edge weights of the
dual graph. The edge weights are the Euclidean lengths of the corresponding mesh edges divided
by the minimum edge length.</p></li>
<li><p>Initialize <a class="reference internal" href="#metis-library-parameters"><span class="std std-ref">all other parameters</span></a> of
the METIS graph partitioner.</p></li>
</ol>
</li>
<li><p><strong>Graph Partition</strong></p>
<ol class="arabic simple">
<li><p>Run the METIS graph partitioner on dual graph with the given weights and other parameters. Let
each partition of the dual graph to be a new patch. Since METIS can produce less partitions
than requested, we have NPATCH &lt;= NPART.</p></li>
</ol>
</li>
<li><p><strong>Split patches</strong></p>
<ol class="arabic simple">
<li><p>Loop through the patches and check whether each patch is connected. If not, then create a new
patch for each of its connected components. This step is needed because METIS is free to
create disconnected partitions with the recommended default parameters.</p></li>
</ol>
</li>
</ol>
</section>
<section id="dual-graph">
<h3>Dual Graph<a class="headerlink" href="#dual-graph" title="Link to this heading"></a></h3>
<p>During initialization, the METIS algorithm constructs the face adjacency graph (i.e. dual graph) of
the enclosure. This graph is then partitioned by the METIS library to produce enclosure patches.</p>
<p>The face adjacency graph is defined by the topology of the mesh and the <a class="reference internal" href="patches_namelist.html#max-angle"><span class="std std-ref">MAX_ANGLE</span></a> namelist parameter which controls the maximum
allowable angle between the (normals of) adjacent faces. Specifically, two topologically adjacent
faces at a angle greater than MAX_ANGLE will not share an edge in the adjacency graph. The
<em>connected components</em> of the face adjacency graph thus represent collections of faces that are
bounded by ‘sharp’ edges (angles greater than MAX_ANGLE) or the mesh boundary itself.</p>
</section>
<section id="partitioning-objective">
<h3>Partitioning objective<a class="headerlink" href="#partitioning-objective" title="Link to this heading"></a></h3>
<p>By default, the METIS algorithm uses the <em>edge-cut</em> partitioning objective (see <a class="reference internal" href="#metis-objtype"><span class="std std-ref">METIS_OBJTYPE</span></a>). With this objective, the number of edges (or the sum of
their weights) that straddle the different partitions is minimized. Also, the number of vertices (or
the sum of their weights) assigned to each partition is constrained to be approximately the same
across the partitions.</p>
<p>The <em>communication volume</em> partitioning objective can also be used, but it is intended for
partitioning meshes among parallel processes. As such, the communication volume objective will not
be discussed in this document but is left as an option for interested users. See the METIS
documentation <span id="id2">[<a class="reference internal" href="#id8" title="George Karypis and Vipin Kumar. A fast and high quality multilevel scheme for partitioning irregular graphs. SIAM J. Sci. Comput., 20(1):359–392, December 1998.">1</a>]</span> for more details on this objective type.</p>
<p>The <a class="reference internal" href="#metis-edge-weight"><span class="std std-ref">METIS_EDGE_WEIGHT</span></a> and
<a class="reference internal" href="#metis-face-weight"><span class="std std-ref">METIS_FACE_WEIGHT</span></a> parameters affect the weights
assigned to the edges and vertices of the dual graph, and thus affect the final patch configuration.
These parameters are discussed in detail below.</p>
<section id="edge-weight">
<h4>Edge Weight<a class="headerlink" href="#edge-weight" title="Link to this heading"></a></h4>
<p>When the <a class="reference internal" href="#metis-edge-weight"><span class="std std-ref">METIS_EDGE_WEIGHT</span></a> parameter is false,
the dual graph edges are assigned a weight of 1. In this case, the number of edges that straddle
different partitions is minimized. In other words, the resulting patches will tend have “smooth”
(locally convex) boundaries since complex boundaries have many dual edges between partitions.</p>
<p>When the parameter is true, the dual graph edges are assigned weights equal to the Euclidean length
of the corresponding edges of the enclosure. In this case, the edge-cut objective minimizes the
perimeter of the resulting patches. This further encourages patches with smooth boundaries, as well
as patches that are roughly circular since circles minimize perimeter for a fixed area
(see the <a class="reference external" href="https://en.wikipedia.org/wiki/Isoperimetric_inequality">isoperimetric inequality</a>).</p>
</section>
<section id="face-weight">
<h4>Face Weight<a class="headerlink" href="#face-weight" title="Link to this heading"></a></h4>
<p>When the <a class="reference internal" href="#metis-face-weight"><span class="std std-ref">METIS_FACE_WEIGHT</span></a> parameter is false,
the dual graph vertices are assigned a weight of 1. In this case, the objective is constrained to
ensure the number of vertices in each partition is approximately the same across the partitions. In
other words, each patch will tend to have the same number of faces.</p>
<p>When the parameter is true, the dual graph vertices are assigned weights equal to the area of the
corresponding faces of the enclosure. In this case, the objective is constrained to ensure the sum
of the weights of the vertices assigned to each partition is the same across the partitions. In
other words, all patches will have roughly the same total area.</p>
<section id="load-imbalance">
<h5>Load Imbalance<a class="headerlink" href="#load-imbalance" title="Link to this heading"></a></h5>
<p>The maximum allowed imbalance in the vertex weight constraint is controlled by the
<a class="reference internal" href="#metis-ufactor"><span class="std std-ref">METIS_UFACTOR</span></a> parameter. The load imbalance for this
constraint is defined to be <span class="math notranslate nohighlight">\(\max_i (w[i]/t[i])\)</span>, where <span class="math notranslate nohighlight">\(w[i]\)</span> is the fraction of the overall weight
that is assigned to the <span class="math notranslate nohighlight">\(i\)</span>th partition and <span class="math notranslate nohighlight">\(t[i]\)</span> is the desired target weight for the <span class="math notranslate nohighlight">\(i\)</span>th
partition. Since the METIS algorithm assigns the same target weight to each partition (i.e. the
METIS library parameter <code class="docutils literal notranslate"><span class="pre">tpwgts</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>), we always have that <span class="math notranslate nohighlight">\(t[i] = 1/\text{NPART}\)</span>, where
NPART is the number of requested partitions.</p>
<p>In the case when METIS_FACE_WEIGHT is false, the load imbalance becomes</p>
<div class="math notranslate nohighlight">
\[max_i \left( \frac{w[i]}{t[i]} \right)
= max_i \left( f[i]\frac{\text{NPART}}{\text{NFACE}} \right)
= max_i \left( \frac{f[i]}{\text{METIS_FACE_PATCH_RATIO}} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(f[i]\)</span> is the number of faces of the <span class="math notranslate nohighlight">\(i\)</span>th patch, NFACE is the total number of faces in the
enclosure, and <a class="reference internal" href="#metis-face-patch-ratio"><span class="std std-ref">METIS_FACE_PATCH_RATIO</span></a> is a
parameter of the METIS algorithm. Note that the load imbalance is close to 1 when the <span class="math notranslate nohighlight">\(i\)</span>th patch
has roughly as many faces as the value of METIS_FACE_PATCH_RATIO.</p>
<p>In the case when METIS_FACE_WEIGHT is true, the load imbalance becomes</p>
<div class="math notranslate nohighlight">
\[max_i \left( \frac{w[i]}{t[i]} \right)
= max_i \left( A[i]\frac{\text{NPART}}{\text{AREA}} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(A[i]\)</span> is the area of the <span class="math notranslate nohighlight">\(i\)</span>th patch and AREA is the total surface area of the enclosure.
Note that if all patches have a load imbalance close to 1, then the total surface area is roughly
evenly distributed among the patches.</p>
<p>By default, <a class="reference internal" href="#metis-ufactor"><span class="std std-ref">METIS_UFACTOR</span></a> is 1, so the maximum
allowed load imbalance is 1.001. This means that the weight of each partition can have a relative
difference to the even distribution of the total weight of at most 0.001. Consider increasing
METIS_UFACTOR if a strictly even distribution of the total weight (faces or surface area) among
patches is not required.</p>
</section>
</section>
</section>
</section>
<section id="namelist-parameters">
<h2>Namelist Parameters<a class="headerlink" href="#namelist-parameters" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="patches_namelist.html"><span class="doc">PATCHES namelist</span></a> allows a user to configure the METIS algorithm
parameters. Although the PATCHES namelist supports many parameters, not all are used by METIS.
Specifically, METIS admits two general parameters, and three parameters used during initialization,
and 12 parameters passed directly to the graph partitioner.</p>
<p>The general parameters used by METIS are VERBOSITY_LEVEL and MAX_ANGLE. Refer to the <a class="reference internal" href="patches_namelist.html#general-parameters"><span class="std std-ref">PATCHES
namelist documentation</span></a> for more
information on those parameters.</p>
<p>The 15 parameters unique to METIS are all prefixed with <em>METIS</em>. We first discuss the three
parameters used during initialization, and then briefly present the 12 METIS library parameters
passed to the graph partitioner.</p>
<section id="initialization-parameters">
<h3>Initialization Parameters<a class="headerlink" href="#initialization-parameters" title="Link to this heading"></a></h3>
<section id="metis-face-patch-ratio">
<h4>METIS_FACE_PATCH_RATIO<a class="headerlink" href="#metis-face-patch-ratio" title="Link to this heading"></a></h4>
<p>Defines the ratio of total faces to total desired patches, and by extension the final number of
patches generated.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">REAL</span></code></p>
<p><strong>Domain:</strong> metis_face_patch_ratio &gt;= 1.0</p>
<p><strong>Default:</strong> meti_face_patch_ratio = 4.0</p>
</div></blockquote>
<p>This parameter determines the number of partitions NPART passed to the METIS graph partitioner:</p>
<div class="math notranslate nohighlight">
\[\text{NPART} = \frac{\text{NFACE}}{\text{METIS_FACE_PATCH_RATIO}}\]</div>
<p>where NFACE is the total number of faces. Since the METIS library is free to produce less partitions
than requested, NPART is not necessarily the final number of patches.</p>
<p>The METIS library must ensure that the constraints on the objective function are satisfied (see
<a class="reference internal" href="#partitioning-objective"><span class="std std-ref">partitioning objective</span></a>), and can thus
produce a drastically different number of partitions than requested. In particular, when
<a class="reference internal" href="#metis-face-weight"><span class="std std-ref">METIS_FACE_WEIGHT</span></a> is enabled for an enclosure
with faces of vastly different sizes, the requirement to evenly divide the total enclosure surface
area among the patches might produce significantly fewer partitions than requested.</p>
<p>Moreover, after the METIS library partitions the dual graph the patch splitting step breaks up
disconnected patches which may increase the final patch count. In short, NPART is only a suggestion
for the final patch count. Consider tweaking other parameters if an exact patch count is desired.</p>
</section>
<section id="metis-edge-weight">
<h4>METIS_EDGE_WEIGHT<a class="headerlink" href="#metis-edge-weight" title="Link to this heading"></a></h4>
<p>Determines whether to weight the edges of the dual graph by the corresponding enclosure edge lengths.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">LOGICAL</span></code></p>
<p><strong>Domain:</strong> Must be <code class="docutils literal notranslate"><span class="pre">.true.</span></code> or <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p>
<p><strong>Default:</strong> metis_edge_weight = <code class="docutils literal notranslate"><span class="pre">.true.</span></code></p>
</div></blockquote>
<p>This parameter determines whether the Euclidean length of the enclosure edges are assigned as edge
weights in the dual graph passed to the METIS library. If the parameter is false, then the dual
graph edges are assigned a weight of 1.</p>
<p>Refer to the <a class="reference internal" href="#edge-weight"><span class="std std-ref">edge weight section</span></a> of the METIS
algorithm documentation for more information on how the parameter affects the final patch
configuration.</p>
</section>
<section id="metis-face-weight">
<h4>METIS_FACE_WEIGHT<a class="headerlink" href="#metis-face-weight" title="Link to this heading"></a></h4>
<p>Determines whether to weight the vertices of the dual graph by the corresponding enclosure face
areas.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">LOGICAL</span></code></p>
<p><strong>Domain:</strong> Must be <code class="docutils literal notranslate"><span class="pre">.true.</span></code> or <code class="docutils literal notranslate"><span class="pre">.false.</span></code></p>
<p><strong>Default:</strong> metis_face_weight = <code class="docutils literal notranslate"><span class="pre">.true.</span></code></p>
</div></blockquote>
<p>This parameter determines whether the area of the enclosure faces are assigned as vertex weights in
the dual graph passed to the METIS library. If the parameter is false, then the dual graph vertices
are assigned a weight of 1.</p>
<p>Refer to the <a class="reference internal" href="#face-weight"><span class="std std-ref">face weight section</span></a> of the METIS
algorithm documentation for more information on how the parameter affects the final patch
configuration.</p>
</section>
</section>
<section id="metis-library-parameters">
<h3>METIS library parameters<a class="headerlink" href="#metis-library-parameters" title="Link to this heading"></a></h3>
<p>The METIS graph partitioning routine admits the following integer-valued options that may be
specified, though all have reasonable defaults so that none must be specified. See the METIS
documentation <span id="id3">[<a class="reference internal" href="#id8" title="George Karypis and Vipin Kumar. A fast and high quality multilevel scheme for partitioning irregular graphs. SIAM J. Sci. Comput., 20(1):359–392, December 1998.">1</a>]</span> for more details on these options.</p>
<section id="metis-ptype">
<h4>METIS_PTYPE<a class="headerlink" href="#metis-ptype" title="Link to this heading"></a></h4>
<p>Specifies the partitioning method.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_ptype <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_ptype = 0</p>
</div></blockquote>
<p>The partitioning methods are encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_ptype = 0</p></td>
<td><p>Multilevel recursive bisection</p></td>
</tr>
<tr class="row-odd"><td><p>metis_ptype = 1</p></td>
<td><p>Multilevel <span class="math notranslate nohighlight">\(k\)</span>-way partitioning</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-objtype">
<h4>METIS_OBJTYPE<a class="headerlink" href="#metis-objtype" title="Link to this heading"></a></h4>
<p>Specifies the type of objective.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_objtype <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_objtype = 0</p>
</div></blockquote>
<p>The objective types are encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_objtype = 0</p></td>
<td><p>Edge-cut minimization.</p></td>
</tr>
<tr class="row-odd"><td><p>metis_objtype = 1</p></td>
<td><p>Total communication volume minimization.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-ctype">
<h4>METIS_CTYPE<a class="headerlink" href="#metis-ctype" title="Link to this heading"></a></h4>
<p>Specifies the matching scheme to be used during coarsening.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_ctype <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_ctype = 1</p>
</div></blockquote>
<p>The matching schemes are encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_ctype = 0</p></td>
<td><p>Random matching</p></td>
</tr>
<tr class="row-odd"><td><p>metis_ctype = 1</p></td>
<td><p>Sorted heavy-edge matching</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-iptype">
<h4>METIS_IPTYPE<a class="headerlink" href="#metis-iptype" title="Link to this heading"></a></h4>
<p>Specifies the algorithm used during initial partitioning (recursive bisection only).</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_iptype <span class="math notranslate nohighlight">\(\in\)</span> {0,1,2,3}</p>
<p><strong>Default:</strong> metis_iptype = 0</p>
</div></blockquote>
<p>The partitioning algorithms are encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_iptype = 0</p></td>
<td><p>Grows a bisection using a greedy strategy</p></td>
</tr>
<tr class="row-odd"><td><p>metis_iptype = 1</p></td>
<td><p>Computes a bisection at random followed by a refinement</p></td>
</tr>
<tr class="row-even"><td><p>metis_iptype = 2</p></td>
<td><p>Derives a separator from an edge cut.</p></td>
</tr>
<tr class="row-odd"><td><p>metis_iptype = 3</p></td>
<td><p>Grow a bisection using a greedy node-based strategy</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-ncuts">
<h4>METIS_NCUTS<a class="headerlink" href="#metis-ncuts" title="Link to this heading"></a></h4>
<p>Specifies the number of different partitionings that will be computed. The final partitioning will
be the one that achieves the best edgecut or communication volume.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_ncuts &gt;= 1</p>
<p><strong>Default:</strong> metis_ncuts = 1</p>
</div></blockquote>
</section>
<section id="metis-niter">
<h4>METIS_NITER<a class="headerlink" href="#metis-niter" title="Link to this heading"></a></h4>
<p>Specifies the number of iterations of the refinement algorithm at each stage of the uncoarsening
process.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_niter &gt;= 1</p>
<p><strong>Default:</strong> metis_niter = 10</p>
</div></blockquote>
</section>
<section id="metis-seed">
<h4>METIS_SEED<a class="headerlink" href="#metis-seed" title="Link to this heading"></a></h4>
<p>Specifies the seed for the random number generator.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_seed <span class="math notranslate nohighlight">\(\in \mathbb{Z}\)</span></p>
<p><strong>Default:</strong> metis_seed = -1</p>
</div></blockquote>
</section>
<section id="metis-minconn">
<h4>METIS_MINCONN<a class="headerlink" href="#metis-minconn" title="Link to this heading"></a></h4>
<p>Specifies whether the partitioning procedure should seek to minimize the maximum degree of the
subdomain graph.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_minconn <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_minconn = 0</p>
</div></blockquote>
<p>The subdomain graph is the graph in which each partition is a node, and edges connect subdomains
with a shared interface. This parameter is encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_minconn = 0</p></td>
<td><p>Does not explicitly minimize the maximum connectivity.</p></td>
</tr>
<tr class="row-odd"><td><p>metis_minconn = 1</p></td>
<td><p>Explicitly minimize the maximum connectivity.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-no2hop">
<h4>METIS_NO2HOP<a class="headerlink" href="#metis-no2hop" title="Link to this heading"></a></h4>
<p>Specifies that the coarsening will not perform any 2–hop matchings when the standard matching
approach fails to sufficiently coarsen the graph.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_no2hop <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_no2hop = 1</p>
</div></blockquote>
<p>The 2–hop matching is very effective for graphs with power-law degree distributions. This parameter
is encoded as follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_no2hop = 0</p></td>
<td><p>Performs a 2–hop matching.</p></td>
</tr>
<tr class="row-odd"><td><p>metis_no2hop = 1</p></td>
<td><p>Does not perform a 2–hop matching.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-contig">
<h4>METIS_CONTIG<a class="headerlink" href="#metis-contig" title="Link to this heading"></a></h4>
<p>Specifies whether the partitioning procedure should produce partitions that are contiguous.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_contig <span class="math notranslate nohighlight">\(\in\)</span> {0,1}</p>
<p><strong>Default:</strong> metis_contig = 0</p>
</div></blockquote>
<p>If the dual graph of the mesh is not connected this option is ignored. This parameter is encoded as
follows:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>metis_contig = 0</p></td>
<td><p>Does not force contiguous partitions.</p></td>
</tr>
<tr class="row-odd"><td><p>metis_contig = 1</p></td>
<td><p>Forces contiguous partitions.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="metis-ufactor">
<h4>METIS_UFACTOR<a class="headerlink" href="#metis-ufactor" title="Link to this heading"></a></h4>
<p>Specifies the maximum allowed load imbalance among the partitions.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_ufactor &gt;= 1</p>
<p><strong>Default:</strong> metis_ufactor = 1</p>
</div></blockquote>
<p>A value of <span class="math notranslate nohighlight">\(n\)</span> indicates that the allowed load imbalance is <span class="math notranslate nohighlight">\((1+n)/1000\)</span>. The default is <span class="math notranslate nohighlight">\(1\)</span> for
recursive bisection (i.e., an imbalance of <span class="math notranslate nohighlight">\(1.001\)</span>) and the default value is <span class="math notranslate nohighlight">\(30\)</span> for <span class="math notranslate nohighlight">\(k\)</span>-way
partitioning (i.e., an imbalance of <span class="math notranslate nohighlight">\(1.03\)</span>).</p>
</section>
<section id="metis-dbglvl">
<h4>METIS_DBGLVL<a class="headerlink" href="#metis-dbglvl" title="Link to this heading"></a></h4>
<p>Specifies the amount and type of diagnostic information that will be written to <strong>stderr</strong> by the
partitioning procedure.</p>
<blockquote class="nml-param">
<div><p><strong>Type:</strong> <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p>
<p><strong>Domain:</strong> metis_dbglvl &gt;= 1</p>
<p><strong>Default:</strong> metis_dbglvl = 0</p>
</div></blockquote>
<p>The default <span class="math notranslate nohighlight">\(0\)</span> means no output. Use <span class="math notranslate nohighlight">\(1\)</span> to write some basic information. Refer to the METIS
documentation <span id="id4">[<a class="reference internal" href="#id8" title="George Karypis and Vipin Kumar. A fast and high quality multilevel scheme for partitioning irregular graphs. SIAM J. Sci. Comput., 20(1):359–392, December 1998.">1</a>]</span> for the many other possible values and the output
they generate.</p>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<div class="docutils container" id="id5">
<div role="list" class="citation-list">
<div class="citation" id="id8" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>,<a role="doc-backlink" href="#id3">3</a>,<a role="doc-backlink" href="#id4">4</a>)</span>
<p>George Karypis and Vipin Kumar. A fast and high quality multilevel scheme for partitioning irregular graphs. <em>SIAM J. Sci. Comput.</em>, 20(1):359–392, December 1998.</p>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vsa.html" class="btn btn-neutral float-left" title="Variational Shape Approximation (VSA)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="vac.html" class="btn btn-neutral float-right" title="Vertex Anchor Cluster (VAC)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Los Alamos National Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>